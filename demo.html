<!doctype html>
<html lang="zh-TW">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Strudel 中文教學 - 用程式碼寫音樂</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      
      body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        line-height: 1.6;
        color: #333;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
      }
      
      .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
      }
      
      header {
        text-align: center;
        color: white;
        margin-bottom: 40px;
      }
      
      h1 {
        font-size: 3em;
        margin-bottom: 10px;
        text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
      }
      
      .subtitle {
        font-size: 1.2em;
        opacity: 0.9;
      }
      
      .section {
        background: white;
        border-radius: 15px;
        padding: 30px;
        margin-bottom: 30px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.1);
      }
      
      .section h2 {
        color: #5a67d8;
        margin-bottom: 20px;
        border-bottom: 3px solid #e2e8f0;
        padding-bottom: 10px;
      }
      
      .tabs {
        display: flex;
        gap: 10px;
        margin-bottom: 20px;
      }
      
      .tab {
        padding: 10px 20px;
        background: #e2e8f0;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        transition: all 0.3s;
      }
      
      .tab.active {
        background: #5a67d8;
        color: white;
      }
      
      .tab-content {
        display: none;
      }
      
      .tab-content.active {
        display: block;
      }
      
      .example-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 20px;
        margin-top: 20px;
      }
      
      .example-card {
        background: #f7fafc;
        border-radius: 10px;
        padding: 20px;
        border-left: 4px solid #5a67d8;
      }
      
      .example-card h4 {
        color: #2d3748;
        margin-bottom: 10px;
      }
      
      .code-block {
        background: #2d3748;
        color: #e2e8f0;
        padding: 15px;
        border-radius: 8px;
        margin: 10px 0;
        font-family: 'Courier New', monospace;
        overflow-x: auto;
      }
      
      .controls {
        display: flex;
        gap: 10px;
        margin: 20px 0;
        justify-content: center;
      }
      
      .btn {
        padding: 12px 24px;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        font-size: 16px;
        transition: all 0.3s;
      }
      
      .btn-primary {
        background: #5a67d8;
        color: white;
      }
      
      .btn-primary:hover {
        background: #4c51bf;
        transform: translateY(-2px);
      }
      
      .btn-secondary {
        background: #e2e8f0;
        color: #2d3748;
      }
      
      .btn-secondary:hover {
        background: #cbd5e0;
      }
      
      .editor-area {
        background: #2d3748;
        border-radius: 10px;
        padding: 20px;
        margin: 20px 0;
      }
      
      #custom-editor {
        width: 100%;
        height: 200px;
        background: #1a202c;
        color: #e2e8f0;
        border: none;
        border-radius: 8px;
        padding: 15px;
        font-family: 'Courier New', monospace;
        font-size: 14px;
        resize: vertical;
      }
      
      .sound-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 15px;
        margin-top: 20px;
      }
      
      .sound-card {
        background: #f7fafc;
        border-radius: 8px;
        padding: 15px;
        text-align: center;
        border: 2px solid transparent;
        transition: all 0.3s;
      }
      
      .sound-card:hover {
        border-color: #5a67d8;
        transform: translateY(-2px);
      }
      
      .iframe-container {
        background: white;
        border-radius: 15px;
        padding: 20px;
        margin: 20px 0;
        text-align: center;
      }
      
      .iframe-container iframe {
        border-radius: 10px;
        border: 2px solid #e2e8f0;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <header>
        <h1>🎵 Strudel 中文教學</h1>
        <p class="subtitle">用程式碼寫音樂，探索 Live Coding 的魅力</p>
      </header>

      <!-- 原始作品展示 -->
      <div class="iframe-container">
        <h3>🌊 經典作品：Coastline by eddyflux</h3>
        <p>這是一個經典的 Strudel 作品，展現了 live coding 音樂的魅力</p>
        <iframe src="https://strudel.cc/#Ly8gImNvYXN0bGluZSIgQGJ5IGVkZHlmbHV4Ci8vIEB2ZXJzaW9uIDEuMApzYW1wbGVzKCdnaXRodWI6ZWRkeWZsdXgvY3JhdGUnKQpzZXRjcHMoLjc1KQpsZXQgY2hvcmRzID0gY2hvcmQoIjxCYm05IEZtOT4vNCIpLmRpY3QoJ2lyZWFsJykKc3RhY2soCiAgc3RhY2soIC8vIERSVU1TCiAgICBzKCJiZCIpLnN0cnVjdCgiPFt4KjwxIDI%2BIFt%2BQDMgeF1dIHg%2BIiksCiAgICBzKCJ%2BIFtyaW0sIHNkOjwyIDM%2BXSIpLnJvb20oIjwwIC4yPiIpLAogICAgbigiWzAgPDEgMz5dKjwyITMgND4iKS5zKCJoaCIpLAogICAgcygicmQ6PDEhMyAyPioyIikubWFzaygiPDAgMCAxIDE%2BLzE2IikuZ2FpbiguNSkKICApLmJhbmsoJ2NyYXRlJykKICAubWFzaygiPFswIDFdIDEgMSAxPi8xNiIuZWFybHkoLjUpKQogICwgLy8gQ0hPUkRTCiAgY2hvcmRzLm9mZnNldCgtMSkudm9pY2luZygpLnMoImdtX2VwaWFubzE6MSIpCiAgLnBoYXNlcig0KS5yb29tKC41KQogICwgLy8gTUVMT0RZCiAgbigiPDAhMyAxKjI%2BIikuc2V0KGNob3JkcykubW9kZSgicm9vdDpnMiIpCiAgLnZvaWNpbmcoKS5zKCJnbV9hY291c3RpY19iYXNzIiksCiAgY2hvcmRzLm4oIlswIDw0IDMgPDIgNT4%2BKjJdKDwzIDU%2BLDgpIikKICAuYW5jaG9yKCJENSIpLnZvaWNpbmcoKQogIC5zZWdtZW50KDQpLmNsaXAocmFuZC5yYW5nZSguNCwuOCkpCiAgLnJvb20oLjc1KS5zaGFwZSguMykuZGVsYXkoLjI1KQogIC5mbShzaW5lLnJhbmdlKDMsOCkuc2xvdyg4KSkKICAubHBmKHNpbmUucmFuZ2UoNTAwLDEwMDApLnNsb3coOCkpLmxwcSg1KQogIC5yYXJlbHkocGx5KCIyIikpLmNodW5rKDQsIGZhc3QoMikpCiAgLmdhaW4ocGVybGluLnJhbmdlKC42LCAuOSkpCiAgLm1hc2soIjwwIDEgMSAwPi8xNiIpCikKLmxhdGUoIlswIC4wMV0qNCIpLmxhdGUoIlswIC4wMV0qMiIpLnNpemUoNCk%3D" width="100%" height="400"></iframe>
      </div>

      <!-- 教學區塊 -->
      <div class="section">
        <h2>📚 Strudel 教學</h2>
        <div class="tabs">
          <button class="tab active" onclick="switchTab('basics')">基礎語法</button>
          <button class="tab" onclick="switchTab('sounds')">音色介紹</button>
          <button class="tab" onclick="switchTab('patterns')">Pattern 技巧</button>
          <button class="tab" onclick="switchTab('effects')">效果器</button>
        </div>

        <div id="basics" class="tab-content active">
          <h3>🎯 基礎語法</h3>
          <div class="example-grid">
            <div class="example-card">
              <h4>播放鼓聲</h4>
              <div class="code-block">s("bd sd hh cp")</div>
              <p>bd=大鼓, sd=小鼓, hh=踩鈸, cp=拍手</p>
              <button class="btn btn-primary" onclick="playExample('s(&quot;bd sd hh cp&quot;).play()')">試聽</button>
            </div>
            <div class="example-card">
              <h4>播放旋律</h4>
              <div class="code-block">note("c4 e4 g4 b4")</div>
              <p>播放 C大調音階</p>
              <button class="btn btn-primary" onclick="playExample('note(&quot;c4 e4 g4 b4&quot;).play()')">試聽</button>
            </div>
            <div class="example-card">
              <h4>重複 Pattern</h4>
              <div class="code-block">s("bd*4")</div>
              <p>*4 表示重複 4 次</p>
              <button class="btn btn-primary" onclick="playExample('s(&quot;bd*4&quot;).play()')">試聽</button>
            </div>
            <div class="example-card">
              <h4>疊加聲部</h4>
              <div class="code-block">stack(s("bd*2"), s("hh*4"))</div>
              <p>同時播放多個 pattern</p>
              <button class="btn btn-primary" onclick="playExample('stack(s(&quot;bd*2&quot;), s(&quot;hh*4&quot;)).play()')">試聽</button>
            </div>
          </div>
        </div>

        <div id="sounds" class="tab-content">
          <h3>🎵 音色介紹</h3>
          <div class="sound-grid">
            <div class="sound-card">
              <h4>鼓組 (Drums)</h4>
              <p><strong>bd</strong> - 大鼓/底鼓</p>
              <p><strong>sd</strong> - 小鼓</p>
              <p><strong>hh</strong> - 踩鈸</p>
              <p><strong>oh</strong> - 開放踩鈸</p>
              <p><strong>cp</strong> - 拍手聲</p>
              <button class="btn btn-secondary" onclick="playExample('s(&quot;bd sd hh oh cp&quot;).play()')">試聽</button>
            </div>
            <div class="sound-card">
              <h4>合成器</h4>
              <p><strong>sawtooth</strong> - 鋸齒波</p>
              <p><strong>square</strong> - 方波</p>
              <p><strong>triangle</strong> - 三角波</p>
              <p><strong>sine</strong> - 正弦波</p>
              <button class="btn btn-secondary" onclick="playExample('note(&quot;c4 e4 g4&quot;).sound(&quot;sawtooth&quot;).play()')">試聽</button>
            </div>
            <div class="sound-card">
              <h4>真實樂器</h4>
              <p><strong>piano</strong> - 鋼琴</p>
              <p><strong>bass</strong> - 貝斯</p>
              <p><strong>guitar</strong> - 吉他</p>
              <p><strong>violin</strong> - 小提琴</p>
              <button class="btn btn-secondary" onclick="playExample('note(&quot;c4 e4 g4&quot;).s(&quot;piano&quot;).play()')">試聽</button>
            </div>
          </div>
        </div>

        <div id="patterns" class="tab-content">
          <h3>🎨 Pattern 技巧</h3>
          <div class="example-grid">
            <div class="example-card">
              <h4>輪替 Pattern</h4>
              <div class="code-block">s("&lt;bd sd&gt;")</div>
              <p>&lt;&gt; 表示輪流播放</p>
              <button class="btn btn-primary" onclick="playExample('s(&quot;&lt;bd sd&gt;&quot;).play()')">試聽</button>
            </div>
            <div class="example-card">
              <h4>群組 Pattern</h4>
              <div class="code-block">s("[bd sd] hh")</div>
              <p>[] 表示群組，在一拍內播放</p>
              <button class="btn btn-primary" onclick="playExample('s(&quot;[bd sd] hh&quot;).play()')">試聽</button>
            </div>
            <div class="example-card">
              <h4>休止符</h4>
              <div class="code-block">s("bd ~ sd ~")</div>
              <p>~ 表示休止符（靜音）</p>
              <button class="btn btn-primary" onclick="playExample('s(&quot;bd ~ sd ~&quot;).play()')">試聽</button>
            </div>
            <div class="example-card">
              <h4>Pattern 反轉</h4>
              <div class="code-block">s("bd sd hh").jux(rev)</div>
              <p>jux(rev) 讓 pattern 反轉播放</p>
              <button class="btn btn-primary" onclick="playExample('s(&quot;bd sd hh&quot;).jux(rev).play()')">試聽</button>
            </div>
          </div>
        </div>

        <div id="effects" class="tab-content">
          <h3>✨ 效果器</h3>
          <div class="example-grid">
            <div class="example-card">
              <h4>音量控制</h4>
              <div class="code-block">.gain(0.5)</div>
              <p>調整音量 (0-1)</p>
              <button class="btn btn-primary" onclick="playExample('s(&quot;bd*4&quot;).gain(0.3).play()')">試聽</button>
            </div>
            <div class="example-card">
              <h4>空間感</h4>
              <div class="code-block">.room(0.8)</div>
              <p>增加殘響效果</p>
              <button class="btn btn-primary" onclick="playExample('s(&quot;bd sd&quot;).room(0.8).play()')">試聽</button>
            </div>
            <div class="example-card">
              <h4>延遲效果</h4>
              <div class="code-block">.delay(0.25)</div>
              <p>增加回音延遲</p>
              <button class="btn btn-primary" onclick="playExample('s(&quot;bd sd&quot;).delay(0.25).play()')">試聽</button>
            </div>
            <div class="example-card">
              <h4>低通濾波</h4>
              <div class="code-block">.lpf(800)</div>
              <p>過濾高頻，讓聲音更溫暖</p>
              <button class="btn btn-primary" onclick="playExample('s(&quot;bd sd hh*4&quot;).lpf(800).play()')">試聽</button>
            </div>
          </div>
        </div>
      </div>

      <!-- 自訂編輯器 -->
      <div class="section">
        <h2>🎹 自訂音樂編輯器</h2>
        <p>在下方編輯器中寫你的 Strudel 程式碼，按下播放來聽聽效果！</p>
        
        <div class="editor-area">
          <textarea id="custom-editor" placeholder="在這裡寫你的 Strudel 程式碼...
例如：
stack(
  s('bd*2 sd*2'),
  s('hh*8'),
  note('c4 e4 g4 b4').s('piano')
)">// 試試看這個範例
stack(
  s("bd*2 sd*2"),
  s("hh*8").gain(0.4),
  note("c4 e4 g4 b4").s("piano").gain(0.6)
)</textarea>
        </div>

        <div class="controls">
          <button id="play-custom" class="btn btn-primary">▶️ 播放我的音樂</button>
          <button id="stop-all" class="btn btn-secondary">⏹️ 停止播放</button>
          <button class="btn btn-secondary" onclick="clearEditor()">🗑️ 清空編輯器</button>
        </div>
      </div>

      <!-- 內建編輯器 -->
      <div class="section">
        <h2>🔧 進階編輯器</h2>
        <p>這是內建的 Strudel 編輯器，具有語法高亮功能：</p>
        <strudel-editor>
          <!--
// 試試看修改這個範例
setcps(1)
stack(
  s("bd*2 sd*2"),
  s("hh*8").gain(0.4),
  note("<c4 e4 g4 b4>*2").scale('C4 minor')
  .s("sawtooth")
  .clip(sine.range(.2,.8).slow(8))
  .jux(rev)
  .room(0.5)
  .lpf(perlin.range(200,2000).slow(4))
)
-->
        </strudel-editor>
      </div>
    </div>

    <script src="https://unpkg.com/@strudel/web@1.0.3"></script>
    <script src="https://unpkg.com/@strudel/repl@latest"></script>
    <script type="module" src="./demo.js"></script>
    <script>
      // 初始化 Strudel
      document.addEventListener('DOMContentLoaded', () => {
        initStrudel();
        
        // 自訂編輯器功能
        document.getElementById('play-custom').addEventListener('click', () => {
          const code = document.getElementById('custom-editor').value;
          try {
            evaluate(code);
          } catch (error) {
            alert('程式碼有錯誤：' + error.message);
          }
        });
        
        document.getElementById('stop-all').addEventListener('click', () => {
          hush();
        });
      });
      
      // 分頁切換
      function switchTab(tabName) {
        // 隱藏所有分頁內容
        document.querySelectorAll('.tab-content').forEach(content => {
          content.classList.remove('active');
        });
        
        // 移除所有分頁按鈕的 active 狀態
        document.querySelectorAll('.tab').forEach(tab => {
          tab.classList.remove('active');
        });
        
        // 顯示選中的分頁內容
        document.getElementById(tabName).classList.add('active');
        
        // 設置選中的分頁按鈕為 active
        event.target.classList.add('active');
      }
      
      // 播放範例
      function playExample(code) {
        try {
          hush(); // 先停止之前的音樂
          setTimeout(() => {
            evaluate(code);
          }, 100);
        } catch (error) {
          alert('播放錯誤：' + error.message);
        }
      }
      
      // 清空編輯器
      function clearEditor() {
        document.getElementById('custom-editor').value = '';
      }
    </script>
  </body>
</html>